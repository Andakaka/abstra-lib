var E=Object.defineProperty;var B=(s,e,n)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var h=(s,e,n)=>(B(s,typeof e!="symbol"?e+"":e,n),n);import{_ as O}from"./DocsButton.vue_vue_type_script_setup_true_lang.9e1a73e4.js";import{_ as y,F as L}from"./AbstraButton.vue_vue_type_script_setup_true_lang.2822e330.js";import{d as N,B as A,f as v,o as l,W as u,Z as D,R as V,es as U,a as f,e as q,cA as $,c as C,w as o,b as i,u as t,d0 as m,cX as I,ax as g,et as Z,eu as z,aJ as k,cY as b,cW as P,ew as j,bD as R}from"./vue-router.baf1d741.js";import{C as _}from"./gateway.6b762f3b.js";import{A as F}from"./Avatar.50192664.js";import{C as G}from"./Card.78006594.js";import{A as W}from"./index.a446ad50.js";import{A as Y}from"./index.afb42b22.js";import"./BookOutlined.d4deed48.js";import"./popupNotifcation.84f234cb.js";import"./TabPane.3f6d70b6.js";import"./isNumeric.75337b1e.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[e]="1a1a25fd-3af7-4a86-90ee-d1180f793253",s._sentryDebugIdIdentifier="sentry-dbid-1a1a25fd-3af7-4a86-90ee-d1180f793253")}catch{}})();const J=["width","height","fill","transform"],X={key:0},K=f("path",{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28Zm-4,176H52V52H204ZM76,128a12,12,0,0,1,12-12h28V88a12,12,0,0,1,24,0v28h28a12,12,0,0,1,0,24H140v28a12,12,0,0,1-24,0V140H88A12,12,0,0,1,76,128Z"},null,-1),Q=[K],ee={key:1},te=f("path",{d:"M216,48V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V48a8,8,0,0,1,8-8H208A8,8,0,0,1,216,48Z",opacity:"0.2"},null,-1),ne=f("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"},null,-1),ae=[te,ne],oe={key:2},ie=f("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM168,136H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32a8,8,0,0,1,0,16Z"},null,-1),re=[ie],se={key:3},le=f("path",{d:"M208,34H48A14,14,0,0,0,34,48V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V48A14,14,0,0,0,208,34Zm2,174a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V48a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2Zm-36-80a6,6,0,0,1-6,6H134v34a6,6,0,0,1-12,0V134H88a6,6,0,0,1,0-12h34V88a6,6,0,0,1,12,0v34h34A6,6,0,0,1,174,128Z"},null,-1),ce=[le],de={key:4},ue=f("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"},null,-1),pe=[ue],he={key:5},ge=f("path",{d:"M208,36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V48A12,12,0,0,0,208,36Zm4,172a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V48a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4Zm-40-80a4,4,0,0,1-4,4H132v36a4,4,0,0,1-8,0V132H88a4,4,0,0,1,0-8h36V88a4,4,0,0,1,8,0v36h36A4,4,0,0,1,172,128Z"},null,-1),me=[ge],fe={name:"PhPlusSquare"},Ce=N({...fe,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(s){const e=s,n=A("weight","regular"),a=A("size","1em"),w=A("color","currentColor"),c=A("mirrored",!1),p=v(()=>{var d;return(d=e.weight)!=null?d:n}),r=v(()=>{var d;return(d=e.size)!=null?d:a}),H=v(()=>{var d;return(d=e.color)!=null?d:w}),x=v(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:c?"scale(-1, 1)":void 0);return(d,ye)=>(l(),u("svg",U({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:r.value,height:r.value,fill:H.value,transform:x.value},d.$attrs),[D(d.$slots,"default"),p.value==="bold"?(l(),u("g",X,Q)):p.value==="duotone"?(l(),u("g",ee,ae)):p.value==="fill"?(l(),u("g",oe,re)):p.value==="light"?(l(),u("g",se,ce)):p.value==="regular"?(l(),u("g",de,pe)):p.value==="thin"?(l(),u("g",he,me)):V("",!0)],16,J))}});class ve{async getLoginUrl(e,n,a){return _.get(`projects/${e}/connectors/${a}/connections/${n}/login-url`)}async listConnections(e){return _.get(`projects/${e}/connections`)}async deleteConnection(e,n){return _.delete(`projects/${e}/connections/${n}`)}async renameConnection(e){const{projectId:n,connectionName:a,connectorType:w,newConnectionName:c}=e;return _.patch(`projects/${n}/connectors/${w}/connections/${a}`,{newConnectionName:c})}}const M={"google-sheets":"https://www.gstatic.com/images/branding/product/1x/sheets_2020q4_48dp.png"},T=[{title:"Google Sheets",type:"google-sheets",description:"Read and write data to Google Sheets."}];class we{constructor(e,n){h(this,"state");h(this,"hasChanges",v(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName));h(this,"handleDeletionClick",async()=>{if(!this.state.value.editingConnection)throw new Error("No connection is being edited");$.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:this.handleDeleteConnection})});h(this,"handleDeleteConnection",async()=>{if(!this.state.value.editingConnection)throw new Error("No connection is being edited");await this.api.deleteConnection(this.projectId,this.state.value.editingConnection.name),this.state.value.editingConnection=null,await this.refetchConnections()});h(this,"handleAddConnectionSubmit",async e=>{const{url:n}=await this.getLoginUrl(e,this.getUniqueName(e));window.location.href=n});h(this,"renameConnection",async()=>{const{editingConnection:e}=this.state.value;if(!e)throw new Error("No connection is being edited");await this.api.renameConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType,newConnectionName:e.newName}),await this.refetchConnections(),this.state.value.editingConnection=null});h(this,"showAddConfirmationModal",e=>{$.confirm({title:"Add connection",content:"You are about to be redirected to the external service to authorize the connection.",icon:null,onOk:()=>this.handleAddConnectionSubmit(e.type)})});this.projectId=e,this.api=n,this.state=q({connections:[],editingConnection:null,showCreateModal:!1})}async refetchConnections(){this.state.value.connections=(await this.api.listConnections(this.projectId)).map(e=>{const n=T.find(a=>a.type===e.connectorType);if(!n)throw new Error(`Unknown connector type: ${e.connectorType}`);return{name:e.name,connectorTitle:n.title,connectorType:e.connectorType,icon:M[e.connectorType]}})}handleEditConnectionClick(e){this.state.value.editingConnection={...e,newName:e.name}}async getLoginUrl(e,n){return this.api.getLoginUrl(this.projectId,n,e)}slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(e){const n=this.state.value.connections.filter(a=>a.connectorType===e).length;return n===0?e:`${e}-${n}`}}const S=N({__name:"ConnectorCard",props:{title:{},avatarImg:{},description:{}},setup(s){return(e,n)=>(l(),C(t(G),{style:{width:"300px"}},{default:o(()=>[i(t(m),{style:{width:"100%"},vertical:"",gap:12},{default:o(()=>[i(t(m),{justify:"space-between"},{default:o(()=>[i(t(F),{src:e.avatarImg,shape:"square",size:"large"},null,8,["src"]),D(e.$slots,"default",{style:"align-self: flex-start"})]),_:3}),i(t(m),{vertical:""},{default:o(()=>[i(t(I),{strong:""},{default:o(()=>[g(Z(e.title),1)]),_:1}),i(t(I),{type:"secondary"},{default:o(()=>[g(Z(e.description),1)]),_:1})]),_:1})]),_:3})]),_:3}))}}),Me=N({__name:"ConnectorsView",setup(s){const n=z().params.projectId,a=new we(n,new ve);return a.refetchConnections(),(w,c)=>{var p;return l(),u(k,null,[i(t(W),{direction:"vertical",style:{width:"100%"}},{default:o(()=>[i(t(m),{align:"center",justify:"space-between"},{default:o(()=>[i(t(b),null,{default:o(()=>[g("Connectors")]),_:1})]),_:1}),i(t(P),null,{default:o(()=>[g(" Add and manage external integrations to your project. "),i(O)]),_:1}),t(a).state.value.connections.length?(l(),C(t(m),{key:0,vertical:""},{default:o(()=>[i(t(b),{level:2},{default:o(()=>[g("Active")]),_:1}),i(t(m),{gap:"10"},{default:o(()=>[(l(!0),u(k,null,j(t(a).state.value.connections,r=>(l(),C(S,{key:r.name,title:r.connectorTitle,"avatar-img":r.icon,description:r.name},{default:o(()=>[i(y,{onClick:H=>t(a).handleEditConnectionClick(r)},{default:o(()=>[i(t(L))]),_:2},1032,["onClick"])]),_:2},1032,["title","avatar-img","description"]))),128))]),_:1})]),_:1})):V("",!0),i(t(m),{vertical:""},{default:o(()=>[t(a).state.value.connections.length?(l(),C(t(b),{key:0,level:2},{default:o(()=>[g("Available")]),_:1})):V("",!0),(l(!0),u(k,null,j(t(T),r=>(l(),C(S,{key:r.type,title:r.title,"avatar-img":t(M)[r.type],description:r.description},{default:o(()=>[i(y,{onClick:H=>t(a).showAddConfirmationModal(r)},{default:o(()=>[i(t(Ce))]),_:2},1032,["onClick"])]),_:2},1032,["title","avatar-img","description"]))),128))]),_:1})]),_:1}),i(t(Y),{open:!!t(a).state.value.editingConnection,title:`${(p=t(a).state.value.editingConnection)==null?void 0:p.connectorTitle} Connection`,onOk:t(a).handleDeletionClick,onClose:c[3]||(c[3]=()=>t(a).state.value.editingConnection=null)},{extra:o(()=>[i(y,{disabled:!t(a).hasChanges.value,onClick:c[0]||(c[0]=r=>t(a).renameConnection())},{default:o(()=>[g(" Save ")]),_:1},8,["disabled"])]),footer:o(()=>[i(t(m),{justify:"end"},{default:o(()=>[i(y,{danger:"",onClick:c[2]||(c[2]=r=>t(a).handleDeletionClick())},{default:o(()=>[g("Delete")]),_:1})]),_:1})]),default:o(()=>[t(a).state.value.editingConnection?(l(),C(t(R),{key:0,value:t(a).state.value.editingConnection.newName,"onUpdate:value":c[1]||(c[1]=r=>t(a).state.value.editingConnection.newName=r)},null,8,["value"])):V("",!0)]),_:1},8,["open","title","onOk"])],64)}}});export{Me as default};
//# sourceMappingURL=ConnectorsView.711249dc.js.map
