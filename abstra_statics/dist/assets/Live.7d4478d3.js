import{C as P}from"./CrudView.fbcb4f6e.js";import{a as U}from"./asyncComputed.0cb1a247.js";import{d as D,W as F,aq as V,u as t,o as u,X as C,aR as z,ee as L,c as I,w as s,b as o,aF as l,ec as x,d9 as k,cN as G,bx as M,$ as E,ed as q,f as H,a as A,bS as N,df as W,da as S,d8 as T,R as X,d3 as Y,f1 as J,db as K,cG as O}from"./vue-router.12ec1d3c.js";import"./gateway.5fc1da7f.js";import{g as Q,B as Z,a as tt}from"./datetime.995acd8c.js";import{P as et}from"./project.095b5006.js";import"./tables.0336ea37.js";import{C as st,r as B}from"./router.85725c38.js";import{u as ot}from"./polling.502232d5.js";import{_ as at,E as rt}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.fa79e840.js";import{G as it}from"./PhArrowCounterClockwise.vue.efe4d00f.js";import{F as R}from"./PhArrowSquareOut.vue.03cfa012.js";import{G as nt}from"./PhChats.vue.2bc84862.js";import{I as lt}from"./PhCopySimple.vue.ecdc3196.js";import{F as dt}from"./PhRocketLaunch.vue.302a863f.js";import{A as ct}from"./index.3c2ee9b8.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.8cee1512.js";import"./BookOutlined.ffa1b54d.js";import"./url.291f83cf.js";import"./PhDotsThreeVertical.vue.f9306eb8.js";import"./index.46c383e5.js";import"./popupNotifcation.6cbc345d.js";import"./record.6383bd9f.js";import"./string.690502ab.js";import"./LoadingOutlined.1418691c.js";(function(){try{var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},i=new Error().stack;i&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[i]="89b24738-204d-4737-9be3-ab9eb08567a9",_._sentryDebugIdIdentifier="sentry-dbid-89b24738-204d-4737-9be3-ab9eb08567a9")}catch{}})();class g{constructor(i,d,m,f){this.major=i,this.minor=d,this.patch=m,this.dev=f}static from(i){if(i===null)return new g(0,0,0);const d=/^(\d+\.\d+\.\d+)(.dev(\d+))?$/,m=i.match(d);if(!m)return new g(0,0,0);const[,f,,w]=m,[h,c,v]=f.split(".").map(Number),y=w?Number(w):void 0;return isNaN(h)||isNaN(c)||isNaN(v)?new g(0,0,0):y&&isNaN(y)?new g(0,0,0):new g(h,c,v,y)}gte(i){return this.major!==i.major?this.major>=i.major:this.minor!==i.minor?this.minor>=i.minor:this.patch>=i.patch}get version(){const i=this.dev?`.dev${this.dev}`:"";return`${this.major}.${this.minor}.${this.patch}${i}`}}const pt=g.from("2.16.10"),ut={key:0,class:"flex-row"},mt={key:1,class:"flex-row"},ft={key:2,class:"flex-row"},gt=D({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(_,{emit:i}){const d=_,m=new rt,{result:f,refetch:w,loading:h}=U(async()=>{const{executions:e}=await m.list({projectId:d.projectId,stageId:d.stageId,limit:6});return e}),c=e=>{i("select",e)},v=e=>Q(e,{weekday:void 0}),{startPolling:y,endPolling:$}=ot({task:w,interval:15e3});return F(()=>y()),V(()=>$()),(e,n)=>t(f)?(u(),C("div",ut,[(u(!0),C(z,null,L(t(f),r=>(u(),I(t(G),{key:r.id,title:v(r.createdAt),onClick:a=>c(r)},{content:s(()=>[o(t(k),null,{default:s(()=>[l("Status: "+x(r.status),1)]),_:2},1024),o(t(k),null,{default:s(()=>[l("Duration: "+x(r.duration_seconds),1)]),_:2},1024),o(t(k),null,{default:s(()=>[l("Build: "+x(r.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[o(at,{status:r.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(h)?(u(),C("div",mt,[o(t(M))])):(u(),C("div",ft,"None"))}});const _t=E(gt,[["__scopeId","data-v-9d19fd00"]]),ht={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},yt={key:1},bt={class:"desc",style:{"margin-bottom":"80px",padding:"10px 30px","background-color":"#f6f6f6","border-radius":"5px"}},kt=D({__name:"Live",setup(_){const d=q().params.projectId,m=()=>{var n;const e=(n=c.value)==null?void 0:n.project.getUrl();e&&window.open(e,"_blank")},f=()=>{var b,p,j;const e=(p=(b=c.value)==null?void 0:b.buildSpec)==null?void 0:p.abstraVersion;if(!e)return;let n="threads";g.from(e).gte(pt)||(n="_player/"+n);const a=((j=c.value)==null?void 0:j.project.getUrl())+n;window.open(a,"_blank")},w=e=>{B.push({name:"logs",params:{projectId:d},query:{stageId:e.stageId,executionId:e.id}})},{loading:h,result:c}=U(async()=>{const n=(await Z.list(d)).find(b=>b.latest);if(!n)return null;const[r,a]=await Promise.all([tt.get(n.id),et.get(d)]);return{buildSpec:r,project:a}}),v=e=>{var a;if(!("path"in e)||!e.path)return;const n=e.type==="form"?`/${e.path}`:`/_hooks/${e.path}`,r=(a=c.value)==null?void 0:a.project.getUrl(n);!r||(navigator.clipboard.writeText(r),O.success("Copied URL to clipboard"))},y=e=>e.type=="form"?`/${e.path}`:e.type=="hook"?`/_hooks/${e.path}`:e.type=="job"?`${e.schedule}`:"",$=H(()=>{var r;const e=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],n=(r=c.value)==null?void 0:r.buildSpec;return n?{columns:e,rows:n.runtimes.map(a=>({key:a.id,cells:[{type:"tag",text:a.type.charAt(0).toUpperCase()+a.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:a}},{type:"slot",key:"trigger",payload:{runtime:a}},{type:"slot",key:"last-runs",payload:{runtime:a}},{type:"actions",actions:[{icon:it,label:"View script logs",onClick:()=>B.push({name:"logs",params:{projectId:d},query:{stageId:a.id}})},{icon:lt,label:"Copy URL",onClick:()=>v(a),hide:!["form","hook"].includes(a.type)}]}]}))}:{columns:e,rows:[]}});return(e,n)=>{var r,a,b;return t(h)||((b=(a=(r=t(c))==null?void 0:r.buildSpec)==null?void 0:a.runtimes.length)!=null?b:0)>0?(u(),I(P,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:$.value,loading:t(h),title:"Live View"},{description:s(()=>[o(t(W),{gap:"middle",style:{"margin-top":"12px"}},{default:s(()=>[o(t(N),{onClick:m},{default:s(()=>[l(" Home"),o(t(R),{class:"icon",size:16})]),_:1}),o(t(N),{onClick:f},{default:s(()=>[l(" Threads"),o(t(R),{class:"icon",size:16})]),_:1})]),_:1})]),title:s(({payload:p})=>{var j;return[A("div",ht,[p.runtime.type!="form"?(u(),I(t(S),{key:0},{default:s(()=>[l(x(p.runtime.title),1)]),_:2},1024)):p.runtime.type=="form"?(u(),I(t(T),{key:1,href:(j=t(c))==null?void 0:j.project.getUrl(p.runtime.path),target:"_blank"},{default:s(()=>[l(x(p.runtime.title),1)]),_:2},1032,["href"])):X("",!0)])]}),"last-runs":s(({payload:p})=>[o(_t,{"stage-id":p.runtime.id,"project-id":t(d),onSelect:w},null,8,["stage-id","project-id"])]),trigger:s(({payload:p})=>[o(t(Y),{color:"default",class:"ellipsis"},{default:s(()=>[l(x(y(p.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(u(),C("section",yt,[A("div",bt,[o(t(K),{style:{display:"flex","align-items":"center",gap:"5px"},level:3},{default:s(()=>[o(t(J),{size:"30"}),l(" Getting started ")]),_:1}),o(t(k),null,{default:s(()=>[l(" Check out the documentation: "),o(t(T),{href:"https://docs.abstra.io",target:"_blank"},{default:s(()=>[l("Abstra Docs")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Install the editor using pip: "),o(t(S),{code:"",copyable:""},{default:s(()=>[l("pip install abstra")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Run the editor: "),o(t(S),{code:"",copyable:""},{default:s(()=>[l("abstra editor my-new-project")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Feeling lost? "),o(t(N),{target:"_blank",type:"default",size:"small",onClick:n[0]||(n[0]=()=>t(st).showNewMessage("I need help getting started with Abstra"))},{default:s(()=>[o(t(nt))]),_:1})]),_:1})]),o(t(ct),{status:"info",title:"Waiting for your first deploy!","sub-title":"Your live stages will appear here once you make your first deploy"},{icon:s(()=>[o(t(dt),{size:"100",color:"#d14056"})]),_:1})]))}}});const Wt=E(kt,[["__scopeId","data-v-0415142e"]]);export{Wt as default};
//# sourceMappingURL=Live.7d4478d3.js.map
