var D=Object.defineProperty;var x=(l,e,a)=>e in l?D(l,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[e]=a;var m=(l,e,a)=>(x(l,typeof e!="symbol"?e+"":e,a),a);import{_ as B}from"./DocsButton.vue_vue_type_script_setup_true_lang.f3febd9b.js";import{d as k,B as v,f as C,o as r,W as d,Z as I,R as O,es as L,a as h,e as E,c as V,w as s,b as i,u as t,d0 as p,cX as b,ax as u,et as H,eu as z,aJ as w,cY as A,cW as P,ew as M,eI as R,cA as $}from"./vue-router.018442b3.js";import{C as _}from"./gateway.19f9e30a.js";import{u as U}from"./uuid.cc1d4a6f.js";import{_ as q}from"./AbstraButton.vue_vue_type_script_setup_true_lang.e8e8e900.js";import{A as G}from"./Avatar.50ac7391.js";import{C as F}from"./Card.690eac7b.js";import{A as W}from"./index.6abbbaad.js";import"./BookOutlined.b761293d.js";import"./popupNotifcation.d2725363.js";import"./TabPane.939af508.js";(function(){try{var l=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[e]="3ab9f9a5-ed51-4374-914b-94295061c3cf",l._sentryDebugIdIdentifier="sentry-dbid-3ab9f9a5-ed51-4374-914b-94295061c3cf")}catch{}})();const Y=["width","height","fill","transform"],J={key:0},X=h("path",{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28Zm-4,176H52V52H204ZM76,128a12,12,0,0,1,12-12h28V88a12,12,0,0,1,24,0v28h28a12,12,0,0,1,0,24H140v28a12,12,0,0,1-24,0V140H88A12,12,0,0,1,76,128Z"},null,-1),K=[X],Q={key:1},ee=h("path",{d:"M216,48V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V48a8,8,0,0,1,8-8H208A8,8,0,0,1,216,48Z",opacity:"0.2"},null,-1),te=h("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"},null,-1),ae=[ee,te],ne={key:2},oe=h("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM168,136H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32a8,8,0,0,1,0,16Z"},null,-1),ie=[oe],se={key:3},le=h("path",{d:"M208,34H48A14,14,0,0,0,34,48V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V48A14,14,0,0,0,208,34Zm2,174a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V48a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2Zm-36-80a6,6,0,0,1-6,6H134v34a6,6,0,0,1-12,0V134H88a6,6,0,0,1,0-12h34V88a6,6,0,0,1,12,0v34h34A6,6,0,0,1,174,128Z"},null,-1),re=[le],ce={key:4},de=h("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"},null,-1),ue=[de],pe={key:5},he=h("path",{d:"M208,36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V48A12,12,0,0,0,208,36Zm4,172a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V48a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4Zm-40-80a4,4,0,0,1-4,4H132v36a4,4,0,0,1-8,0V132H88a4,4,0,0,1,0-8h36V88a4,4,0,0,1,8,0v36h36A4,4,0,0,1,172,128Z"},null,-1),ge=[he],fe={name:"PhPlusSquare"},me=k({...fe,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(l){const e=l,a=v("weight","regular"),o=v("size","1em"),y=v("color","currentColor"),g=v("mirrored",!1),n=C(()=>{var c;return(c=e.weight)!=null?c:a}),f=C(()=>{var c;return(c=e.size)!=null?c:o}),S=C(()=>{var c;return(c=e.color)!=null?c:y}),j=C(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:g?"scale(-1, 1)":void 0);return(c,ye)=>(r(),d("svg",L({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:f.value,height:f.value,fill:S.value,transform:j.value},c.$attrs),[I(c.$slots,"default"),n.value==="bold"?(r(),d("g",J,K)):n.value==="duotone"?(r(),d("g",Q,ae)):n.value==="fill"?(r(),d("g",ne,ie)):n.value==="light"?(r(),d("g",se,re)):n.value==="regular"?(r(),d("g",ce,ue)):n.value==="thin"?(r(),d("g",pe,ge)):O("",!0)],16,Y))}});class ve{async getLoginUrl(e,a,o){return _.get(`projects/${e}/connectors/${a}/connections/${o}/login-url`)}async listConnections(e){return _.get(`projects/${e}/connections`)}async deleteConnection(e,a,o){return _.delete(`projects/${e}/connectors/${o}/connections/${a}`)}}const T={"google-sheets":"https://www.gstatic.com/images/branding/product/1x/sheets_2020q4_48dp.png"},N=[{title:"Google Sheets",type:"google-sheets",description:"Read and write data to Google Sheets."}];class Ce{constructor(e,a){m(this,"state");m(this,"deleteConnection",async()=>{await this.api.deleteConnection(this.projectId,this.state.value.editingConnection.connectionName,this.state.value.editingConnection.connectorType),await this.refetchConnections()});m(this,"handleAddConnectionSubmit",async()=>{if(!this.state.value.editingConnection)return;const{url:e}=await this.getLoginUrl(this.state.value.editingConnection.connectorType,this.slugify(this.state.value.editingConnection.connectionName));window.location.href=e});this.projectId=e,this.api=a,this.state=E({connections:[],editingConnection:null,showCreateModal:!1,showDeleteModal:!1})}async refetchConnections(){this.state.value.connections=(await this.api.listConnections(this.projectId)).map(e=>{const a=N.find(o=>o.type===e.connectorType);if(!a)throw new Error(`Unknown connector type: ${e.connectorType}`);return{name:e.name,connectorTitle:a.title,connectorType:e.connectorType,icon:T[e.connectorType]}})}closeModals(){this.state.value.showCreateModal=!1,this.state.value.showDeleteModal=!1,this.state.value.editingConnection=null}handleDeleteConnectionClick(e){this.state.value.showDeleteModal=!0,this.state.value.editingConnection={connectionName:e.name,connectorType:e.connectorType}}async getLoginUrl(e,a){return this.api.getLoginUrl(this.projectId,e,a)}handleAddConnectionClick(e){this.state.value.showCreateModal=!0,this.state.value.editingConnection={connectionName:`${e.type}_${U().split("-")[0]}`,connectorType:e.type}}slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}}const Z=k({__name:"ConnectorCard",props:{title:{},avatarImg:{},description:{}},emits:["click"],setup(l,{emit:e}){return(a,o)=>(r(),V(t(F),{style:{width:"300px"}},{default:s(()=>[i(t(p),{style:{width:"100%"},vertical:"",gap:12},{default:s(()=>[i(t(p),{justify:"space-between"},{default:s(()=>[i(t(G),{src:a.avatarImg,shape:"square",size:"large"},null,8,["src"]),i(q,{style:{"align-self":"flex-start"},onClick:o[0]||(o[0]=y=>e("click"))},{default:s(()=>[I(a.$slots,"button-icon")]),_:3})]),_:3}),i(t(p),{vertical:""},{default:s(()=>[i(t(b),{strong:""},{default:s(()=>[u(H(a.title),1)]),_:1}),i(t(b),{type:"secondary"},{default:s(()=>[u(H(a.description),1)]),_:1})]),_:1})]),_:3})]),_:3}))}}),Ne=k({__name:"ConnectorsView",setup(l){const a=z().params.projectId,o=new Ce(a,new ve);return o.refetchConnections(),(y,g)=>(r(),d(w,null,[i(t(W),{direction:"vertical",style:{width:"100%"}},{default:s(()=>[i(t(p),{align:"center",justify:"space-between"},{default:s(()=>[i(t(A),null,{default:s(()=>[u("Connectors")]),_:1})]),_:1}),i(t(P),null,{default:s(()=>[u(" Add and manage external integrations to your project. "),i(B)]),_:1}),i(t(p),{vertical:""},{default:s(()=>[i(t(A),{level:2},{default:s(()=>[u("Active")]),_:1}),i(t(p),{gap:"10"},{default:s(()=>[(r(!0),d(w,null,M(t(o).state.value.connections,n=>(r(),V(Z,{key:n.name,title:n.connectorTitle,"avatar-img":n.icon,description:n.name,onClick:f=>t(o).handleDeleteConnectionClick(n)},{"button-icon":s(()=>[i(t(R))]),_:2},1032,["title","avatar-img","description","onClick"]))),128))]),_:1})]),_:1}),i(t(p),{vertical:""},{default:s(()=>[i(t(A),{level:2},{default:s(()=>[u("Available")]),_:1}),(r(!0),d(w,null,M(t(N),n=>(r(),V(Z,{key:n.type,title:n.title,"avatar-img":t(T)[n.type],description:n.description,onClick:f=>t(o).handleAddConnectionClick(n)},{"button-icon":s(()=>[i(t(me))]),_:2},1032,["title","avatar-img","description","onClick"]))),128))]),_:1})]),_:1}),i(t($),{open:t(o).state.value.showCreateModal,title:"Add Connection",closable:!1,onOk:t(o).handleAddConnectionSubmit,onCancel:g[0]||(g[0]=n=>t(o).closeModals())},{default:s(()=>[u(" You are about to be redirected to the external service to authorize the connection. ")]),_:1},8,["open","onOk"]),i(t($),{open:t(o).state.value.showDeleteModal,title:"Delete connection",closable:!1,onOk:t(o).deleteConnection,onCancel:g[1]||(g[1]=n=>t(o).closeModals())},{default:s(()=>{var n;return[u(" Are you sure you want to delete "+H((n=t(o).state.value.editingConnection)==null?void 0:n.connectionName)+" connection? ",1)]}),_:1},8,["open","onOk"])],64))}});export{Ne as default};
//# sourceMappingURL=ConnectorsView.9592fd1f.js.map
