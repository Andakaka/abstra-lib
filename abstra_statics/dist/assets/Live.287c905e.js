import{C as V}from"./CrudView.f125f931.js";import{a as R}from"./asyncComputed.a2be0755.js";import{d as U,V as L,ai as z,u as t,o as f,W as C,aJ as F,ex as P,c as $,w as o,b as a,ax as n,eu as j,cX as k,cD as G,bp as M,$ as E,ev as W,f as H,a as S,bL as A,d1 as q,cY as N,cW as T,R as Y,f8 as J,cZ as X,cw as Z}from"./vue-router.28b113b5.js";import"./gateway.c036da04.js";import{g as K,B as O,a as Q}from"./datetime.995c3f5c.js";import{P as tt}from"./project.20bfa210.js";import"./tables.a57cdc4a.js";import{r as B,C as et}from"./router.2490aba0.js";import{_ as st,E as ot}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.e0eea857.js";import{G as at}from"./PhArrowCounterClockwise.vue.4d5748c5.js";import{F as D}from"./PhArrowSquareOut.vue.22e82221.js";import{G as rt}from"./PhChats.vue.2e082c0a.js";import{I as it}from"./PhCopySimple.vue.b771747d.js";import{F as nt}from"./PhRocketLaunch.vue.5dffae53.js";import{A as lt}from"./index.9b848d27.js";import{A as ct}from"./index.b93b64d8.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.66c3e1cd.js";import"./BookOutlined.6ccce4a8.js";import"./url.c0fe2d6b.js";import"./PhDotsThree.vue.1de62c89.js";import"./index.88847a2c.js";import"./popupNotifcation.08f5d811.js";import"./record.f6e9cbea.js";import"./string.0d5e6ffd.js";import"./LoadingOutlined.22a577f0.js";(function(){try{var y=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},i=new Error().stack;i&&(y._sentryDebugIds=y._sentryDebugIds||{},y._sentryDebugIds[i]="8ddcfcd4-dc0c-4de9-a1be-64cdb45392d2",y._sentryDebugIdIdentifier="sentry-dbid-8ddcfcd4-dc0c-4de9-a1be-64cdb45392d2")}catch{}})();class g{constructor(i,l,m,_){this.major=i,this.minor=l,this.patch=m,this.dev=_}static from(i){if(i===null)return new g(0,0,0);const l=/^(\d+\.\d+\.\d+)(.dev(\d+))?$/,m=i.match(l);if(!m)return new g(0,0,0);const[,_,,v]=m,[b,c,x]=_.split(".").map(Number),u=v?Number(v):void 0;return isNaN(b)||isNaN(c)||isNaN(x)?new g(0,0,0):u&&isNaN(u)?new g(0,0,0):new g(b,c,x,u)}gte(i){return this.major!==i.major?this.major>=i.major:this.minor!==i.minor?this.minor>=i.minor:this.patch>=i.patch}get version(){const i=this.dev?`.dev${this.dev}`:"";return`${this.major}.${this.minor}.${this.patch}${i}`}}const dt=g.from("2.16.10"),pt={key:0,class:"flex-row"},ut={key:1,class:"flex-row"},ft={key:2,class:"flex-row"},mt=U({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(y,{emit:i}){const l=y,m=new ot,{result:_,refetch:v,loading:b}=R(async()=>{const{executions:h}=await m.list({projectId:l.projectId,stageId:l.stageId,limit:6});return h}),c=h=>{i("select",h)},x=h=>K(h,{weekday:void 0});let u=null;return L(()=>{u=setInterval(()=>v(),15e3)}),z(()=>{u&&clearInterval(u)}),(h,e)=>t(_)?(f(),C("div",pt,[(f(!0),C(F,null,P(t(_),s=>(f(),$(t(G),{key:s.id,title:x(s.createdAt),onClick:d=>c(s)},{content:o(()=>[a(t(k),null,{default:o(()=>[n("Status: "+j(s.status),1)]),_:2},1024),a(t(k),null,{default:o(()=>[n("Duration: "+j(s.duration_seconds),1)]),_:2},1024),a(t(k),null,{default:o(()=>[n("Build: "+j(s.buildId.slice(0,6)),1)]),_:2},1024)]),default:o(()=>[a(st,{status:s.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(b)?(f(),C("div",ut,[a(t(M))])):(f(),C("div",ft,"None"))}});const _t=E(mt,[["__scopeId","data-v-da0ef620"]]),ht={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},gt={key:1},yt={class:"desc",style:{"margin-bottom":"80px",padding:"10px 30px","background-color":"#f6f6f6","border-radius":"5px"}},bt=U({__name:"Live",setup(y){const l=W().params.projectId,m=()=>{var s;const e=(s=c.value)==null?void 0:s.project.getUrl();e&&window.open(e,"_blank")},_=()=>{var w,p,I;const e=(p=(w=c.value)==null?void 0:w.buildSpec)==null?void 0:p.abstraVersion;if(!e)return;let s="threads";g.from(e).gte(dt)||(s="_player/"+s);const r=((I=c.value)==null?void 0:I.project.getUrl())+s;window.open(r,"_blank")},v=e=>{B.push({name:"logs",params:{projectId:l},query:{stageId:e.stageId,executionId:e.id}})},{loading:b,result:c}=R(async()=>{const s=(await O.list(l)).find(w=>w.latest);if(!s)return null;const[d,r]=await Promise.all([Q.get(s.id),tt.get(l)]);return{buildSpec:d,project:r}}),x=e=>{var r;if(!("path"in e)||!e.path)return;const s=e.type==="form"?`/${e.path}`:`/_hooks/${e.path}`,d=(r=c.value)==null?void 0:r.project.getUrl(s);!d||(navigator.clipboard.writeText(d),Z.success("Copied URL to clipboard"))},u=e=>e.type=="form"?`/${e.path}`:e.type=="hook"?`/_hooks/${e.path}`:e.type=="job"?`${e.schedule}`:"",h=H(()=>{var d;const e=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],s=(d=c.value)==null?void 0:d.buildSpec;return s?{columns:e,rows:s.runtimes.map(r=>({key:r.id,cells:[{type:"tag",text:r.type.charAt(0).toUpperCase()+r.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:r}},{type:"slot",key:"trigger",payload:{runtime:r}},{type:"slot",key:"last-runs",payload:{runtime:r}},{type:"actions",actions:[{icon:at,label:"View script logs",onClick:()=>B.push({name:"logs",params:{projectId:l},query:{stageId:r.id}})},{icon:it,label:"Copy URL",onClick:()=>x(r),hide:!["form","hook"].includes(r.type)}]}]}))}:{columns:e,rows:[]}});return(e,s)=>{var d,r,w;return t(b)||((w=(r=(d=t(c))==null?void 0:d.buildSpec)==null?void 0:r.runtimes.length)!=null?w:0)>0?(f(),$(V,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:h.value,loading:t(b),title:"Live View"},{description:o(()=>[a(t(q),{gap:"middle",style:{"margin-top":"12px"}},{default:o(()=>[a(t(A),{onClick:m},{default:o(()=>[n(" Home"),a(t(D),{class:"icon",size:16})]),_:1}),a(t(A),{onClick:_},{default:o(()=>[n(" Threads"),a(t(D),{class:"icon",size:16})]),_:1})]),_:1})]),title:o(({payload:p})=>{var I;return[S("div",ht,[p.runtime.type!="form"?(f(),$(t(N),{key:0},{default:o(()=>[n(j(p.runtime.title),1)]),_:2},1024)):p.runtime.type=="form"?(f(),$(t(T),{key:1,href:(I=t(c))==null?void 0:I.project.getUrl(p.runtime.path),target:"_blank"},{default:o(()=>[n(j(p.runtime.title),1)]),_:2},1032,["href"])):Y("",!0)])]}),"last-runs":o(({payload:p})=>[a(_t,{"stage-id":p.runtime.id,"project-id":t(l),onSelect:v},null,8,["stage-id","project-id"])]),trigger:o(({payload:p})=>[a(t(ct),{color:"default",class:"ellipsis"},{default:o(()=>[n(j(u(p.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(f(),C("section",gt,[S("div",yt,[a(t(X),{style:{display:"flex","align-items":"center",gap:"5px"},level:3},{default:o(()=>[a(t(J),{size:"30"}),n(" Getting started ")]),_:1}),a(t(k),null,{default:o(()=>[n(" Check out the documentation: "),a(t(T),{href:"https://docs.abstra.app",target:"_blank"},{default:o(()=>[n("Abstra Docs")]),_:1})]),_:1}),a(t(k),null,{default:o(()=>[n(" Install the editor using pip: "),a(t(N),{code:"",copyable:""},{default:o(()=>[n("pip install abstra")]),_:1})]),_:1}),a(t(k),null,{default:o(()=>[n(" Run the editor: "),a(t(N),{code:"",copyable:""},{default:o(()=>[n("abstra editor my-new-project")]),_:1})]),_:1}),a(t(k),null,{default:o(()=>[n(" Feeling lost? "),a(t(A),{target:"_blank",type:"default",size:"small",onClick:s[0]||(s[0]=()=>t(et).showNewMessage("I need help getting started with Abstra"))},{default:o(()=>[a(t(rt))]),_:1})]),_:1})]),a(t(lt),{status:"info",title:"Waiting for your first deploy!","sub-title":"Your live stages will appear here once you make your first deploy"},{icon:o(()=>[a(t(nt),{size:"100",color:"#d14056"})]),_:1})]))}}});const Ht=E(bt,[["__scopeId","data-v-89f52d8b"]]);export{Ht as default};
//# sourceMappingURL=Live.287c905e.js.map
