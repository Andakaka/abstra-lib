import{C as P}from"./CrudView.6f85f43a.js";import{a as U}from"./asyncComputed.b54c1816.js";import{d as D,V,ai as L,u as t,o as u,W as C,aJ as z,e9 as F,c as I,w as s,b as o,ax as l,e6 as x,d3 as k,cH as M,bp as G,$ as E,e7 as H,f as W,a as S,bL as A,d9 as q,d4 as N,d2 as T,R as J,cZ as Y,eM as Z,d5 as K,cA as O}from"./vue-router.8691855a.js";import"./gateway.332a789a.js";import{g as Q,B as X,a as tt}from"./datetime.7330ae8f.js";import{P as et}from"./project.b3da67d0.js";import"./tables.28a36928.js";import{r as B,C as st}from"./router.29bda5cc.js";import{u as ot}from"./polling.4cd72f79.js";import{_ as at,E as rt}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.3caff8a9.js";import{G as it}from"./PhArrowCounterClockwise.vue.43fa0ba3.js";import{F as R}from"./PhArrowSquareOut.vue.226e93d5.js";import{G as nt}from"./PhChats.vue.c32b3c49.js";import{I as lt}from"./PhCopySimple.vue.94fb640f.js";import{F as dt}from"./PhRocketLaunch.vue.06712249.js";import{A as ct}from"./index.f39ff1fb.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.7cb8b26a.js";import"./BookOutlined.ba12266a.js";import"./url.90ab2d9e.js";import"./PhDotsThreeVertical.vue.3a8cf7a3.js";import"./index.e89afae5.js";import"./popupNotifcation.89324e27.js";import"./record.4bbdf897.js";import"./string.3ebdf426.js";import"./LoadingOutlined.0604f3a6.js";(function(){try{var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},i=new Error().stack;i&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[i]="c157882a-81b3-4434-b283-de76cd250d9e",_._sentryDebugIdIdentifier="sentry-dbid-c157882a-81b3-4434-b283-de76cd250d9e")}catch{}})();class g{constructor(i,d,m,f){this.major=i,this.minor=d,this.patch=m,this.dev=f}static from(i){if(i===null)return new g(0,0,0);const d=/^(\d+\.\d+\.\d+)(.dev(\d+))?$/,m=i.match(d);if(!m)return new g(0,0,0);const[,f,,w]=m,[h,c,v]=f.split(".").map(Number),y=w?Number(w):void 0;return isNaN(h)||isNaN(c)||isNaN(v)?new g(0,0,0):y&&isNaN(y)?new g(0,0,0):new g(h,c,v,y)}gte(i){return this.major!==i.major?this.major>=i.major:this.minor!==i.minor?this.minor>=i.minor:this.patch>=i.patch}get version(){const i=this.dev?`.dev${this.dev}`:"";return`${this.major}.${this.minor}.${this.patch}${i}`}}const pt=g.from("2.16.10"),ut={key:0,class:"flex-row"},mt={key:1,class:"flex-row"},ft={key:2,class:"flex-row"},gt=D({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(_,{emit:i}){const d=_,m=new rt,{result:f,refetch:w,loading:h}=U(async()=>{const{executions:e}=await m.list({projectId:d.projectId,stageId:d.stageId,limit:6});return e}),c=e=>{i("select",e)},v=e=>Q(e,{weekday:void 0}),{startPolling:y,endPolling:$}=ot({task:w,interval:15e3});return V(()=>y()),L(()=>$()),(e,n)=>t(f)?(u(),C("div",ut,[(u(!0),C(z,null,F(t(f),r=>(u(),I(t(M),{key:r.id,title:v(r.createdAt),onClick:a=>c(r)},{content:s(()=>[o(t(k),null,{default:s(()=>[l("Status: "+x(r.status),1)]),_:2},1024),o(t(k),null,{default:s(()=>[l("Duration: "+x(r.duration_seconds),1)]),_:2},1024),o(t(k),null,{default:s(()=>[l("Build: "+x(r.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[o(at,{status:r.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(h)?(u(),C("div",mt,[o(t(G))])):(u(),C("div",ft,"None"))}});const _t=E(gt,[["__scopeId","data-v-9d19fd00"]]),ht={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},yt={key:1},bt={class:"desc",style:{"margin-bottom":"80px",padding:"10px 30px","background-color":"#f6f6f6","border-radius":"5px"}},kt=D({__name:"Live",setup(_){const d=H().params.projectId,m=()=>{var n;const e=(n=c.value)==null?void 0:n.project.getUrl();e&&window.open(e,"_blank")},f=()=>{var b,p,j;const e=(p=(b=c.value)==null?void 0:b.buildSpec)==null?void 0:p.abstraVersion;if(!e)return;let n="threads";g.from(e).gte(pt)||(n="_player/"+n);const a=((j=c.value)==null?void 0:j.project.getUrl())+n;window.open(a,"_blank")},w=e=>{B.push({name:"logs",params:{projectId:d},query:{stageId:e.stageId,executionId:e.id}})},{loading:h,result:c}=U(async()=>{const n=(await X.list(d)).find(b=>b.latest);if(!n)return null;const[r,a]=await Promise.all([tt.get(n.id),et.get(d)]);return{buildSpec:r,project:a}}),v=e=>{var a;if(!("path"in e)||!e.path)return;const n=e.type==="form"?`/${e.path}`:`/_hooks/${e.path}`,r=(a=c.value)==null?void 0:a.project.getUrl(n);!r||(navigator.clipboard.writeText(r),O.success("Copied URL to clipboard"))},y=e=>e.type=="form"?`/${e.path}`:e.type=="hook"?`/_hooks/${e.path}`:e.type=="job"?`${e.schedule}`:"",$=W(()=>{var r;const e=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],n=(r=c.value)==null?void 0:r.buildSpec;return n?{columns:e,rows:n.runtimes.map(a=>({key:a.id,cells:[{type:"tag",text:a.type.charAt(0).toUpperCase()+a.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:a}},{type:"slot",key:"trigger",payload:{runtime:a}},{type:"slot",key:"last-runs",payload:{runtime:a}},{type:"actions",actions:[{icon:it,label:"View script logs",onClick:()=>B.push({name:"logs",params:{projectId:d},query:{stageId:a.id}})},{icon:lt,label:"Copy URL",onClick:()=>v(a),hide:!["form","hook"].includes(a.type)}]}]}))}:{columns:e,rows:[]}});return(e,n)=>{var r,a,b;return t(h)||((b=(a=(r=t(c))==null?void 0:r.buildSpec)==null?void 0:a.runtimes.length)!=null?b:0)>0?(u(),I(P,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:$.value,loading:t(h),title:"Live View"},{description:s(()=>[o(t(q),{gap:"middle",style:{"margin-top":"12px"}},{default:s(()=>[o(t(A),{onClick:m},{default:s(()=>[l(" Home"),o(t(R),{class:"icon",size:16})]),_:1}),o(t(A),{onClick:f},{default:s(()=>[l(" Threads"),o(t(R),{class:"icon",size:16})]),_:1})]),_:1})]),title:s(({payload:p})=>{var j;return[S("div",ht,[p.runtime.type!="form"?(u(),I(t(N),{key:0},{default:s(()=>[l(x(p.runtime.title),1)]),_:2},1024)):p.runtime.type=="form"?(u(),I(t(T),{key:1,href:(j=t(c))==null?void 0:j.project.getUrl(p.runtime.path),target:"_blank"},{default:s(()=>[l(x(p.runtime.title),1)]),_:2},1032,["href"])):J("",!0)])]}),"last-runs":s(({payload:p})=>[o(_t,{"stage-id":p.runtime.id,"project-id":t(d),onSelect:w},null,8,["stage-id","project-id"])]),trigger:s(({payload:p})=>[o(t(Y),{color:"default",class:"ellipsis"},{default:s(()=>[l(x(y(p.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(u(),C("section",yt,[S("div",bt,[o(t(K),{style:{display:"flex","align-items":"center",gap:"5px"},level:3},{default:s(()=>[o(t(Z),{size:"30"}),l(" Getting started ")]),_:1}),o(t(k),null,{default:s(()=>[l(" Check out the documentation: "),o(t(T),{href:"https://docs.abstra.app",target:"_blank"},{default:s(()=>[l("Abstra Docs")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Install the editor using pip: "),o(t(N),{code:"",copyable:""},{default:s(()=>[l("pip install abstra")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Run the editor: "),o(t(N),{code:"",copyable:""},{default:s(()=>[l("abstra editor my-new-project")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Feeling lost? "),o(t(A),{target:"_blank",type:"default",size:"small",onClick:n[0]||(n[0]=()=>t(st).showNewMessage("I need help getting started with Abstra"))},{default:s(()=>[o(t(nt))]),_:1})]),_:1})]),o(t(ct),{status:"info",title:"Waiting for your first deploy!","sub-title":"Your live stages will appear here once you make your first deploy"},{icon:s(()=>[o(t(dt),{size:"100",color:"#d14056"})]),_:1})]))}}});const qt=E(kt,[["__scopeId","data-v-89f52d8b"]]);export{qt as default};
//# sourceMappingURL=Live.65420acc.js.map
