import{C as P}from"./CrudView.b7c32ec8.js";import{a as U}from"./asyncComputed.982eaa66.js";import{d as D,W as F,aq as V,u as t,o as u,X as C,aR as z,ee as L,c as I,w as s,b as o,aF as l,ec as x,d9 as k,cN as G,bx as M,$ as E,ed as q,f as H,a as A,bS as N,df as W,da as S,d8 as T,R as X,d3 as Y,f1 as J,db as K,cG as O}from"./vue-router.0c866027.js";import"./gateway.0ef21e5f.js";import{g as Q,B as Z,a as tt}from"./datetime.c18d8780.js";import{P as et}from"./project.3d363c01.js";import"./tables.efb5f012.js";import{C as st,r as B}from"./router.1e2b485f.js";import{u as ot}from"./polling.72ce848f.js";import{_ as at,E as rt}from"./ExecutionStatusIcon.vue_vue_type_script_setup_true_lang.1f3a7a34.js";import{G as it}from"./PhArrowCounterClockwise.vue.784bb2c5.js";import{F as R}from"./PhArrowSquareOut.vue.9de9626c.js";import{G as nt}from"./PhChats.vue.e221accc.js";import{I as lt}from"./PhCopySimple.vue.265d8215.js";import{F as ct}from"./PhRocketLaunch.vue.6dd58fda.js";import{A as dt}from"./index.ddb5c2e4.js";import"./DocsButton.vue_vue_type_script_setup_true_lang.13208669.js";import"./BookOutlined.ad59ac41.js";import"./url.292545d8.js";import"./PhDotsThreeVertical.vue.efed2e5c.js";import"./index.10fe6907.js";import"./popupNotifcation.e8b26059.js";import"./record.36ebc23b.js";import"./string.23ad9559.js";import"./LoadingOutlined.9844cd76.js";(function(){try{var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},i=new Error().stack;i&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[i]="53accc1e-ff30-415b-bf51-ea02eba05276",_._sentryDebugIdIdentifier="sentry-dbid-53accc1e-ff30-415b-bf51-ea02eba05276")}catch{}})();class g{constructor(i,c,f,m){this.major=i,this.minor=c,this.patch=f,this.dev=m}static from(i){if(i===null)return new g(0,0,0);const c=/^(\d+\.\d+\.\d+)(.dev(\d+))?$/,f=i.match(c);if(!f)return new g(0,0,0);const[,m,,w]=f,[h,d,v]=m.split(".").map(Number),y=w?Number(w):void 0;return isNaN(h)||isNaN(d)||isNaN(v)?new g(0,0,0):y&&isNaN(y)?new g(0,0,0):new g(h,d,v,y)}gte(i){return this.major!==i.major?this.major>=i.major:this.minor!==i.minor?this.minor>=i.minor:this.patch>=i.patch}get version(){const i=this.dev?`.dev${this.dev}`:"";return`${this.major}.${this.minor}.${this.patch}${i}`}}const pt=g.from("2.16.10"),ut={key:0,class:"flex-row"},ft={key:1,class:"flex-row"},mt={key:2,class:"flex-row"},gt=D({__name:"ExecutionsShort",props:{stageId:{},projectId:{}},emits:["select"],setup(_,{emit:i}){const c=_,f=new rt,{result:m,refetch:w,loading:h}=U(async()=>{const{executions:e}=await f.list({projectId:c.projectId,stageId:c.stageId,limit:6});return e}),d=e=>{i("select",e)},v=e=>Q(e,{weekday:void 0}),{startPolling:y,endPolling:$}=ot({task:w,interval:15e3});return F(()=>y()),V(()=>$()),(e,n)=>t(m)?(u(),C("div",ut,[(u(!0),C(z,null,L(t(m),r=>(u(),I(t(G),{key:r.id,title:v(r.createdAt),onClick:a=>d(r)},{content:s(()=>[o(t(k),null,{default:s(()=>[l("Status: "+x(r.status),1)]),_:2},1024),o(t(k),null,{default:s(()=>[l("Duration: "+x(r.duration_seconds),1)]),_:2},1024),o(t(k),null,{default:s(()=>[l("Build: "+x(r.buildId.slice(0,6)),1)]),_:2},1024)]),default:s(()=>[o(at,{status:r.status},null,8,["status"])]),_:2},1032,["title","onClick"]))),128))])):t(h)?(u(),C("div",ft,[o(t(M))])):(u(),C("div",mt,"None"))}});const _t=E(gt,[["__scopeId","data-v-9d19fd00"]]),ht={style:{"max-width":"250px",overflow:"hidden","text-overflow":"ellipsis ellipsis","white-space":"nowrap"}},yt={key:1},bt={class:"desc",style:{"margin-bottom":"80px",padding:"10px 30px","background-color":"#f6f6f6","border-radius":"5px"}},kt=D({__name:"Live",setup(_){const c=q().params.projectId,f=()=>{var n;const e=(n=d.value)==null?void 0:n.project.getUrl();e&&window.open(e,"_blank")},m=()=>{var b,p,j;const e=(p=(b=d.value)==null?void 0:b.buildSpec)==null?void 0:p.abstraVersion;if(!e)return;let n="threads";g.from(e).gte(pt)||(n="_player/"+n);const a=((j=d.value)==null?void 0:j.project.getUrl())+n;window.open(a,"_blank")},w=e=>{B.push({name:"logs",params:{projectId:c},query:{stageId:e.stageId,executionId:e.id}})},{loading:h,result:d}=U(async()=>{const n=(await Z.list(c)).find(b=>b.latest);if(!n)return null;const[r,a]=await Promise.all([tt.get(n.id),et.get(c)]);return{buildSpec:r,project:a}}),v=e=>{var a;if(!("path"in e)||!e.path)return;const n=e.type==="form"?`/${e.path}`:`/_hooks/${e.path}`,r=(a=d.value)==null?void 0:a.project.getUrl(n);!r||(navigator.clipboard.writeText(r),O.success("Copied URL to clipboard"))},y=e=>e.type=="form"?`/${e.path}`:e.type=="hook"?`/_hooks/${e.path}`:e.type=="job"?`${e.schedule}`:"",$=H(()=>{var r;const e=[{name:"Type",align:"left"},{name:"Title",align:"left"},{name:"Trigger",align:"left"},{name:"Last Runs"},{name:"",align:"right"}],n=(r=d.value)==null?void 0:r.buildSpec;return n?{columns:e,rows:n.runtimes.map(a=>({key:a.id,cells:[{type:"tag",text:a.type.charAt(0).toUpperCase()+a.type.slice(1),tagColor:"default"},{type:"slot",key:"title",payload:{runtime:a}},{type:"slot",key:"trigger",payload:{runtime:a}},{type:"slot",key:"last-runs",payload:{runtime:a}},{type:"actions",actions:[{icon:it,label:"View script logs",onClick:()=>B.push({name:"logs",params:{projectId:c},query:{stageId:a.id}})},{icon:lt,label:"Copy URL",onClick:()=>v(a),hide:!["form","hook"].includes(a.type)}]}]}))}:{columns:e,rows:[]}});return(e,n)=>{var r,a,b;return t(h)||((b=(a=(r=t(d))==null?void 0:r.buildSpec)==null?void 0:a.runtimes.length)!=null?b:0)>0?(u(),I(P,{key:0,"empty-title":"","entity-name":"build",description:"Access and monitor your project's current scripts here.",table:$.value,loading:t(h),title:"Live View"},{description:s(()=>[o(t(W),{gap:"middle",style:{"margin-top":"12px"}},{default:s(()=>[o(t(N),{onClick:f},{default:s(()=>[l(" Home"),o(t(R),{class:"icon",size:16})]),_:1}),o(t(N),{onClick:m},{default:s(()=>[l(" Threads"),o(t(R),{class:"icon",size:16})]),_:1})]),_:1})]),title:s(({payload:p})=>{var j;return[A("div",ht,[p.runtime.type!="form"?(u(),I(t(S),{key:0},{default:s(()=>[l(x(p.runtime.title),1)]),_:2},1024)):p.runtime.type=="form"?(u(),I(t(T),{key:1,href:(j=t(d))==null?void 0:j.project.getUrl(p.runtime.path),target:"_blank"},{default:s(()=>[l(x(p.runtime.title),1)]),_:2},1032,["href"])):X("",!0)])]}),"last-runs":s(({payload:p})=>[o(_t,{"stage-id":p.runtime.id,"project-id":t(c),onSelect:w},null,8,["stage-id","project-id"])]),trigger:s(({payload:p})=>[o(t(Y),{color:"default",class:"ellipsis"},{default:s(()=>[l(x(y(p.runtime)),1)]),_:2},1024)]),_:1},8,["table","loading"])):(u(),C("section",yt,[A("div",bt,[o(t(K),{style:{display:"flex","align-items":"center",gap:"5px"},level:3},{default:s(()=>[o(t(J),{size:"30"}),l(" Getting started ")]),_:1}),o(t(k),null,{default:s(()=>[l(" Check out the documentation: "),o(t(T),{href:"https://docs.abstra.io",target:"_blank"},{default:s(()=>[l("Abstra Docs")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Install the editor using pip: "),o(t(S),{code:"",copyable:""},{default:s(()=>[l("pip install abstra")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Run the editor: "),o(t(S),{code:"",copyable:""},{default:s(()=>[l("abstra editor my-new-project")]),_:1})]),_:1}),o(t(k),null,{default:s(()=>[l(" Feeling lost? "),o(t(N),{target:"_blank",type:"default",size:"small",onClick:n[0]||(n[0]=()=>t(st).showNewMessage("I need help getting started with Abstra"))},{default:s(()=>[o(t(nt))]),_:1})]),_:1})]),o(t(dt),{status:"info",title:"Waiting for your first deploy!","sub-title":"Your live stages will appear here once you make your first deploy"},{icon:s(()=>[o(t(ct),{size:"100",color:"#d14056"})]),_:1})]))}}});const Wt=E(kt,[["__scopeId","data-v-90c62d52"]]);export{Wt as default};
//# sourceMappingURL=Live.bc3babac.js.map
