import{d as b,eR as B,g as E,V as L,a7 as D,o as k,c as A,w as s,Z as v,u as l,A as I,cE as U,b as t,$ as S,L as $,N as P,e as w,W as V,a as T,d1 as H,ax as h,d2 as N,bL as x,cH as Y,cF as z}from"./vue-router.717c9672.js";import{G as K}from"./PhFloppyDisk.vue.cf114e9a.js";import{E as M}from"./ExclamationCircleOutlined.82b04103.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[o]="2b539ae2-fcae-4132-a023-8cf8fc6c0390",n._sentryDebugIdIdentifier="sentry-dbid-2b539ae2-fcae-4132-a023-8cf8fc6c0390")}catch{}})();const C="You have unsaved changes. Are you sure you want to leave?",O=b({__name:"UnsavedChangesHandler",props:{hasChanges:{type:Boolean}},setup(n){const o=n,r=a=>(a=a||window.event,a&&(a.returnValue=C),C),p=()=>{window.addEventListener("beforeunload",r)};B(async(a,i,d)=>{if(!o.hasChanges)return d();await new Promise(e=>{U.confirm({title:"You have unsaved changes.",icon:t(M),content:"Are you sure you want to discard them?",okText:"Discard Changes",okType:"danger",cancelText:"Cancel",onOk(){e(!0)},onCancel(){e(!1)}})})?d():d(!1)});const c=()=>window.removeEventListener("beforeunload",r),u=a=>a?p():c();return E(()=>o.hasChanges,u),L(()=>u(o.hasChanges)),D(c),(a,i)=>(k(),A(l(I),{theme:{token:{colorPrimary:"#d14056"}}},{default:s(()=>[v(a.$slots,"default",{},void 0,!0)]),_:3}))}});const R=S(O,[["__scopeId","data-v-08510d52"]]),F={class:"popup-container"},G={style:{padding:"0px 4px"}},W=b({__name:"SaveButton",props:{model:{},neverShowPopover:{type:Boolean}},emits:["save"],setup(n,{emit:o}){var g;const r=n,p=e=>{var f;return(f=e.parentElement)!=null?f:document.body},c=new $(P.boolean(),"dontShowUnsavedChanges"),u=w((g=c.get())!=null?g:!1),a=()=>{c.set(!0),u.value=!0},i=w(!1);async function d(){i.value=!0;try{await r.model.save(),o("save")}catch{z.error({message:"Error saving"})}finally{i.value=!1}}return addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key==="s"&&(e.preventDefault(),d())}),addEventListener("beforeunload",e=>{r.model.hasChanges()&&(e.preventDefault(),e.returnValue="")}),(e,f)=>{var m;return k(),V("div",F,[t(l(Y),{placement:"left",open:e.model.hasChanges()&&!u.value&&!e.neverShowPopover,"get-popup-container":p},{content:s(()=>[T("div",G,[t(l(H),null,{default:s(()=>[h("You have unsaved changes")]),_:1}),t(l(N),{onClick:a},{default:s(()=>[h("Don't show this again")]),_:1})])]),default:s(()=>{var y;return[t(l(x),{class:"save-button",loading:i.value,disabled:!((y=e.model)!=null&&y.hasChanges()),onClick:f[0]||(f[0]=_=>d())},{icon:s(()=>[v(e.$slots,"icon",{},()=>[t(l(K),{size:"18"})],!0)]),default:s(()=>{var _;return[(_=e.model)!=null&&_.hasChanges()?v(e.$slots,"with-changes",{key:0},()=>[h(" Save ")],!0):v(e.$slots,"without-changes",{key:1},()=>[h(" Saved ")],!0)]}),_:3},8,["loading","disabled"])]}),_:3},8,["open"]),t(R,{"has-changes":(m=e.model)==null?void 0:m.hasChanges()},null,8,["has-changes"])])}}});const J=S(W,[["__scopeId","data-v-e79e182b"]]);export{J as S};
//# sourceMappingURL=SaveButton.028f0b84.js.map
