import{d as C,eR as B,g as E,V as L,a7 as D,o as k,c as A,w as s,Z as p,u as l,A as I,cE as U,b as t,$ as S,L as $,N as P,e as w,W as V,a as T,d1 as H,ax as v,d2 as N,bL as x,cH as Y,cF as z}from"./vue-router.eed3d3bc.js";import{G as K}from"./PhFloppyDisk.vue.94f1f59a.js";import{E as M}from"./ExclamationCircleOutlined.c2dc788a.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[o]="482aa056-8f93-4eb5-a515-ba7d5e843514",n._sentryDebugIdIdentifier="sentry-dbid-482aa056-8f93-4eb5-a515-ba7d5e843514")}catch{}})();const b="You have unsaved changes. Are you sure you want to leave?",O=C({__name:"UnsavedChangesHandler",props:{hasChanges:{type:Boolean}},setup(n){const o=n,r=a=>(a=a||window.event,a&&(a.returnValue=b),b),f=()=>{window.addEventListener("beforeunload",r)};B(async(a,c,d)=>{if(!o.hasChanges)return d();await new Promise(e=>{U.confirm({title:"You have unsaved changes.",icon:t(M),content:"Are you sure you want to discard them?",okText:"Discard Changes",okType:"danger",cancelText:"Cancel",onOk(){e(!0)},onCancel(){e(!1)}})})?d():d(!1)});const u=()=>window.removeEventListener("beforeunload",r),i=a=>a?f():u();return E(()=>o.hasChanges,i),L(()=>i(o.hasChanges)),D(u),(a,c)=>(k(),A(l(I),{theme:{token:{colorPrimary:"#d14056"}}},{default:s(()=>[p(a.$slots,"default",{},void 0,!0)]),_:3}))}});const R=S(O,[["__scopeId","data-v-08510d52"]]),F={class:"popup-container"},G={style:{padding:"0px 4px"}},W=C({__name:"SaveButton",props:{model:{},neverShowPopover:{type:Boolean}},emits:["save"],setup(n,{emit:o}){var g;const r=n,f=e=>{var h;return(h=e.parentElement)!=null?h:document.body},u=new $(P.boolean(),"dontShowUnsavedChanges"),i=w((g=u.get())!=null?g:!1),a=()=>{u.set(!0),i.value=!0},c=w(!1);async function d(){c.value=!0;try{await r.model.save(),o("save")}catch{z.error({message:"Error saving"})}finally{c.value=!1}}return addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key==="s"&&(e.preventDefault(),d())}),addEventListener("beforeunload",e=>{r.model.hasChanges()&&(e.preventDefault(),e.returnValue="")}),(e,h)=>{var m;return k(),V("div",F,[t(l(Y),{placement:"left",open:e.model.hasChanges()&&!i.value&&!e.neverShowPopover,"get-popup-container":f},{content:s(()=>[T("div",G,[t(l(H),null,{default:s(()=>[v("You have unsaved changes")]),_:1}),t(l(N),{onClick:a},{default:s(()=>[v("Don't show this again")]),_:1})])]),default:s(()=>{var y;return[t(l(x),{class:"save-button",loading:c.value,disabled:!((y=e.model)!=null&&y.hasChanges()),onClick:h[0]||(h[0]=_=>d())},{icon:s(()=>[p(e.$slots,"icon",{},()=>[t(l(K),{size:"18"})],!0)]),default:s(()=>{var _;return[(_=e.model)!=null&&_.hasChanges()?p(e.$slots,"with-changes",{key:0},()=>[v(" Save ")],!0):p(e.$slots,"without-changes",{key:1},()=>[v(" Saved ")],!0)]}),_:3},8,["loading","disabled"])]}),_:3},8,["open"]),t(R,{"has-changes":(m=e.model)==null?void 0:m.hasChanges()},null,8,["has-changes"])])}}});const J=S(W,[["__scopeId","data-v-e79e182b"]]);export{J as S};
//# sourceMappingURL=SaveButton.b61e115c.js.map
